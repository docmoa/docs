<template><div><h1 id="_05-α„α…¦α„…α…΅α„‘α…©α†·-α„‰α…΅α†Όα„α…Άα„‘α…΅α„‹α…µα†―-state" tabindex="-1"><a class="header-anchor" href="#_05-α„α…¦α„…α…΅α„‘α…©α†·-α„‰α…΅α†Όα„α…Άα„‘α…΅α„‹α…µα†―-state" aria-hidden="true">#</a> 05. ν…λΌνΌ μƒνƒνμΌ(State)</h1>
<h2 id="terraform-state" tabindex="-1"><a class="header-anchor" href="#terraform-state" aria-hidden="true">#</a> Terraform State</h2>
<p>Terraformμ€ <sub>stateful</sub> μ• ν”λ¦¬μΌ€μ΄μ…μ…λ‹λ‹¤. μ¦‰, state file λ‚΄λ¶€μ—μ„ λΉλ“ ν• λ¨λ“  λ‚΄μ©μ„ μ¶”μ ν•©λ‹λ‹¤.</p>
<p>μ•μ„μ μ‹¤μµμ—μ„ λ°λ³µλ <code v-pre>Apply</code> μ‘μ—… κ°„μ— Workspace λ””λ ‰ν† λ¦¬μ— λ‚νƒ€λ‚ <code v-pre>terraform.tfstate</code> λ° <code v-pre>terraform.tfstate.backup</code> νμΌμ„ λ³΄μ…¨μ„ κ²ƒμ…λ‹λ‹¤.</p>
<p>μƒνƒ νμΌμ€ Terraformμ΄ μ•κ³ μλ” λ¨λ“  κ²ƒμ— λ€ν• κΈ°λ΅ μ†μ¤μ…λ‹λ‹¤.</p>
<p>::: vue<br>
WORKSPACE<br>
β”β”€β”€ files<br>
β”‚   β””β”€β”€ deploy_app.sh<br>
β”β”€β”€ <a href="http://main.tf" target="_blank" rel="noopener noreferrer">main.tf<ExternalLinkIcon/></a><br>
β”β”€β”€ <a href="http://outputs.tf" target="_blank" rel="noopener noreferrer">outputs.tf<ExternalLinkIcon/></a><br>
β”β”€β”€ <code v-pre>terraform.tfstate</code><br>
β”β”€β”€ <code v-pre>terraform.tfstate.backup</code><br>
β”β”€β”€ terraform.tfvars<br>
β””β”€β”€ <a href="http://variables.tf" target="_blank" rel="noopener noreferrer">variables.tf<ExternalLinkIcon/></a><br>
:::</p>
<p>State νμΌ λ‚΄λ¶€λ” JSON ν•μ‹μΌλ΅ κµ¬μ„±λμ–΄μμµλ‹λ‹¤.</p>
<div class="language-json line-numbers-mode" data-ext="json"><pre v-pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
  <span class="token property">"terraform_version"</span><span class="token operator">:</span> <span class="token string">"0.12.7"</span><span class="token punctuation">,</span>
  <span class="token property">"serial"</span><span class="token operator">:</span> <span class="token number">14</span><span class="token punctuation">,</span>
  <span class="token property">"lineage"</span><span class="token operator">:</span> <span class="token string">"452b4191-89f6-db17-a3b1-4470dcb00607"</span><span class="token punctuation">,</span>
  <span class="token property">"outputs"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"catapp_url"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"http://go-hashicat-5c0265179ccda553.workshop.aws.hashidemos.io"</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"string"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="terraform-refresh" tabindex="-1"><a class="header-anchor" href="#terraform-refresh" aria-hidden="true">#</a> Terraform Refresh</h2>
<p>λ•λ•λ΅ μΈν”„λΌλ” Terraformμ΄ ν†µμ ν•λ” λ²”μ„ λ°–μ—μ„ λ³€κ²½ λ  μ μμµλ‹λ‹¤. (μλ™μΌλ΅ UIμ—μ„ λ³€κ²½ λ“±)</p>
<p>State νμΌμ€ μΈν”„λΌμ λ§μ§€λ§‰μΌλ΅ κ°±μ‹ λ μƒνƒλ¥Ό λ‚νƒ€λƒ…λ‹λ‹¤. μƒνƒ νμΌμ΄ λΉλ“ ν• νμΌκ³Ό μ—¬μ „ν μΌμΉν•λ”μ§€ ν™•μΈν•κ³  ν™•μΈν•λ ¤λ©΄ <code v-pre>terraform refresh</code> λ…λ Ήμ„ μ‚¬μ©ν•  μ μμµλ‹λ‹¤.</p>
<p>μ΄κ²ƒμ€ μΈν”„λΌλ¥Ό μ—…λ°μ΄νΈν•μ§€ μ•λ” μƒνƒ νμΌ λ§ μ—…λ°μ΄νΈν•©λ‹λ‹¤.</p>
<div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code>terraform refresh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="α„€α…µα„α…©α†«-α„‹α…µα†«α„‘α…³α„…α…΅-α„‡α…§α†«α„€α…§α†Ό" tabindex="-1"><a class="header-anchor" href="#α„€α…µα„α…©α†«-α„‹α…µα†«α„‘α…³α„…α…΅-α„‡α…§α†«α„€α…§α†Ό" aria-hidden="true">#</a> κΈ°μ΅΄ μΈν”„λΌ λ³€κ²½</h2>
<p>κ³„νμ„ μ‹¤ν–‰ν•κ±°λ‚ μ μ© ν•  λ•λ§λ‹¤ Terraformμ€ μ„Έ κ°€μ§€ λ°μ΄ν„° μ†μ¤λ¥Ό μ΅°μ •ν•©λ‹λ‹¤.</p>
<ol>
<li>μ½”λ“μ— μ‘μ„±ν• λ‚΄μ©</li>
<li>μƒνƒ νμΌ</li>
<li>μ‹¤μ λ΅ μ΅΄μ¬ν•λ” κ²ƒ</li>
</ol>
<p>Terraformμ€ <code v-pre>*.tf</code> νμΌμ—μλ” λ‚΄μ©μ„ κΈ°λ°μΌλ΅ κΈ°μ΅΄ λ¦¬μ†μ¤λ¥Ό μ¶”κ°€, μ‚­μ , λ³€κ²½ λλ” κµμ²΄ν•κΈ° μ„ν•΄ <mark>μµμ„ </mark> μ„ λ‹¤ν•©λ‹λ‹¤. λ‹¤μμ€ Plan/Apply μ¤‘μ— κ° λ¦¬μ†μ¤μ— λ°μƒν•  μμλ” λ„¤ κ°€μ§€ μ‚¬ν•­μ…λ‹λ‹¤.</p>
<div class="language-diff line-numbers-mode" data-ext="diff"><pre v-pre class="language-diff"><code><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   create
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">   destroy
</span><span class="token prefix deleted">-</span><span class="token line">/+ replace
</span></span>~   update in-place
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container warning">
<p class="hint-container-title">κ²½κ³ </p>
<p>λ¬΄μ—‡μΈκ°€ λ³€κ²½ν• λ• <code v-pre>-/+ replace</code>κ°€ λ°μƒν•λ”μ§€ ν™•μΈν•μ„Έμ”. μ΄κ²ƒμ€ κΈ°μ΅΄ λ¦¬μ†μ¤λ¥Ό μ‚­μ ν•κ³  λ‹¤μ‹ μƒμ„±ν•©λ‹λ‹¤.</p>
</div>
<h2 id="terraform-state-quiz" tabindex="-1"><a class="header-anchor" href="#terraform-state-quiz" aria-hidden="true">#</a> π± Terraform State Quiz :</h2>
<p>κ° μ‹λ‚λ¦¬μ¤μ—μ„ μ–΄λ–¤ μΌμ΄ λ°μƒν•©λ‹κΉ? λ…Όμν•΄ λ³ΌκΉμ”?</p>
<table>
<thead>
<tr>
<th style="text-align:center">Configuration(.tf)</th>
<th style="text-align:center">State</th>
<th style="text-align:center">Reality</th>
<th style="text-align:center">Operation</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">ncloud_server</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">???</td>
</tr>
<tr>
<td style="text-align:center">ncloud_server</td>
<td style="text-align:center">ncloud_server</td>
<td style="text-align:center"></td>
<td style="text-align:center">???</td>
</tr>
<tr>
<td style="text-align:center">ncloud_server</td>
<td style="text-align:center">ncloud_server</td>
<td style="text-align:center">ncloud_server</td>
<td style="text-align:center">???</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">ncloud_server</td>
<td style="text-align:center">ncloud_server</td>
<td style="text-align:center">???</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">ncloud_server</td>
<td style="text-align:center">???</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">ncloud_server</td>
<td style="text-align:center"></td>
<td style="text-align:center">???</td>
</tr>
</tbody>
</table>
<details class="hint-container details"><summary>λ‹µ</summary>
<table>
<thead>
<tr>
<th style="text-align:center">Configuration(.tf)</th>
<th style="text-align:center">State</th>
<th style="text-align:center">Reality</th>
<th style="text-align:center">Operation</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">ncloud_server</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">create</td>
</tr>
<tr>
<td style="text-align:center">ncloud_server</td>
<td style="text-align:center">ncloud_server</td>
<td style="text-align:center"></td>
<td style="text-align:center">create</td>
</tr>
<tr>
<td style="text-align:center">ncloud_server</td>
<td style="text-align:center">ncloud_server</td>
<td style="text-align:center">ncloud_server</td>
<td style="text-align:center">-</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">ncloud_server</td>
<td style="text-align:center">ncloud_server</td>
<td style="text-align:center">delete</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">ncloud_server</td>
<td style="text-align:center">-</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">ncloud_server</td>
<td style="text-align:center"></td>
<td style="text-align:center">update state</td>
</tr>
</tbody>
</table>
</details>
</div></template>


